---
permalink: guides/couchbase-lite/objc/document/index.html
---

In Couchbase Lite, a document's body takes the form of a JSON object â€” a collection of key/value pairs where the values can be different types of data such as numbers, strings, arrays or even nested objects. Every document is identified by a document ID, which can be automatically generated (as a UUID) or determined by the application; the only constraints are that it must be unique within the database, and it can't be changed.

## Initializers

The following methods/initializers can be used:

- The `MutableDocument()` initializer can be used to create a new document where the document ID is randomly generated by the database.
- The `MutableDocument(withID: String)` initializer can be used to create a new document with a specific ID.
- The `database.document(withID: String)` method can be used to  get a document. If it doesn't exist in the database, it will return `nil`. This method can be used to check if a document with a given ID already exists in the database.

The following code example creates a document and persists it to the database.

```objectivec
let dict: [String: Any] = ["type": "task",
                           "owner": "todo",
                           "createdAt": Date()]
let newTask = MutableDocument(withData: dict)
try? database.saveDocument(newTask)
```

## Mutability

The biggest change is that `MutableDocument` properties are now directly mutable. Instead of having to make a mutable copy of the properties dictionary, update it, and then save it back to the document, you can now modify individual properties in place and then save.

```objectivec
// newTask is a MutableDocument
newTask.setString("apples", forKey: "name")
try? database.saveDocument(newTask)
```

This does create the possibility of confusion, since the document's in-memory state may not match what's in the database. Unsaved changes are not visible to other `Database` instances (i.e. other threads that may have other instances), or to queries.

## Typed Accessors

The `Document` class now offers a set of [`property accessors`](http://docs.couchbase.com/mobile/2.0/couchbase-lite-objc/db021/Protocols/CBLDictionary.html#/Type%20Setters) for various scalar types, including boolean, integers, floating-point and strings. These accessors take care of converting to/from JSON encoding, and make sure you get the type you're expecting: for example, `document.string(forKey: String)` returns either a `String` or `nil`, so you can't get an unexpected object class and crash trying to use it as a string. (Even if the property in the document has an incompatible type, the accessor returns `nil`.)

In addition, as a convenience we offer `Date` accessors. Dates are a common data type, but JSON doesn't natively support them, so the convention is to store them as strings in ISO-8601 format. The following example sets the date on the `createdAt` property and reads it back using the `document.date(forKey: String)` accessor method.

```objectivec
newTask.setValue(Date(), forKey: "createdAt")
let date = newTask.date(forKey: "createdAt")
```

## Batch operations

If you're making multiple changes to a database at once, it's *much* faster to group them together, otherwise each individual change incurs overhead, from flushing writes to the filesystem to ensure durability. In 2.0 we've renamed the method from `inTransaction()` to `inBatch()` to emphasize that Couchbase Lite does not offer transactional guarantees, and that the purpose of the method is to optimize batch operations rather than to enable ACID transactions. The following example persists a few documents in batch.

```objectivec
do {
    try database.inBatch {
        for i in 0...10 {
            let doc = MutableDocument()
            doc.setValue("user", forKey: "type")
            doc.setValue("user \(i)", forKey: "name")
            doc.setBoolean(false, forKey: "admin")
            try database.saveDocument(doc)
            print("saved user document \(doc.string(forKey: "name"))")
        }
    }
} catch let error {
    print(error.localizedDescription)
}
```

At the **local** level this operation is still transactional: no other `Database` instances, including ones managed by the replicator can make changes during the execution of the block, and other instances will not see partial changes. But Couchbase Mobile is a distributed system, and due to the way replication works, there's no guarantee that Sync Gateway or other devices will receive your changes all at once.

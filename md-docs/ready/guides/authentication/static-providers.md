---
id: other-providers
title: Other Providers
permalink: ready/guides/authentication/static-providers/index.html
---

### Facebook authentication

The Couchbase Sync Gateway allows users to authenticate using a Facebook account. Your application is responsible for generating a Facebook token; this generally needs to be done by running the Facebook login flow inside a web-view and capturing the generated token. Facebook provides SDKs for both iOS and Android to assist in doing this, and on iOS the Accounts framework can be used to retrieve an active login token (with the user's consent.)

You'll also need to ensure you've asked for the `email` permission in your Facebook app configuration.

Sync Gateway supports [Facebook Login](https://developers.facebook.com/docs/facebook-login/), which allows users to log in by using their Facebook account. To enable it, add a top-level `facebook` property to your server configuration file. For example:

```javascript
"facebook" : {
   "register" : true
}
```

Clients log in by sending a POST request to `/dbname/_facebook`, with a JSON body that contains the following objects:

- `access_token`: Access token returned by Facebook
- `email`: Email address of the user
- `remote_url`: Sync Gateway replication endpoint URL

Just as with a `_session` login, the response sets a session cookie.

The server will send the token to Facebook's servers to validate it, and if successful will generate a login session and return a session cookie to the app. The session will eventually expire, so you should be prepared to detect an authentication failure (HTTP 401 status) reported by the replication, and get a new token from Facebook.

### Persona authentication

[Persona](https://login.persona.org/) is a universal login system developed by the Mozilla Foundation. It uses any 
email address as the user 
identity, so one isn't required to have an account at any particular social-networking site. Otherwise, from the app perspective, it works similarly to Facebook auth: the app needs to get a token (called an "assertion") that's generated by the user's logging in on a website, and send that assertion to the remote database server.

Once you have the token, you just need to call a factory method to create an Authenticator from it, and assign that to the replication's authenticator property.

The server will send the token to persona.org to validate it, and if successful will generate a login session and return a session cookie to the app. The session will eventually expire, so you should be prepared to detect an authentication failure (HTTP 401 status) reported by the replication, and generate a new assertion.

Sync Gateway supports [Mozilla Persona](https://developer.mozilla.org/en-US/docs/persona), a sign-in system for the web that allows clients to authenticate by using an email address. You can enable Persona either by modifying your server configuration file or by starting Sync Gateway with an additional command-line option.

To enable Persona by modifying the configuration file, add a top-level `persona` property to the `config.json` file. The value of the ` persona property is an object with an origin property that contains your server's canonical root URL as seen by clients. For example:

```javascript
"persona" : {
   "origin" : "http://example.com/",
   "register" : true
}
```

To enable Persona when you start Sync Gateway, add the `-personaOrigin` option to the command line and specify the server's canonical root URL. For example:

```bash
$ sync_gateway -personaOrigin http://example.com
```

The `origin` URL must be specified explicitly because the Persona protocol requires both client and server to agree on the server's identity, and there's no reliable way to derive the URL on the server, especially if it's behind a proxy.

After that's set up, you need to set the `email` property of the user accounts, so that the server can look up the account based on the email address given in the Persona credentials.

Clients log in by sending a POST request to `/dbname/_persona`. The request body is a JSON document that contains an assertion property whose value is the signed `assertion` received from the identity provider. Just as with a `_session` login, the response sets a session cookie.

## Facebook and Persona Account Registration

If the `register` property of the Facebook or Persona configuration is true, then clients can implicitly register new user accounts by authenticating through Facebook or Persona. If Sync Gateway verifies the client's assertion, but no existing user account has that email address, it creates a new user account for that email and returns a session cookie.

The user name for the new account is the same as the authenticated email address and has a random password. There is no way to retrieve the password, so in the future the client must continue to log in by using Facebook or Persona, unless the app server replaces the password with one known to the client.
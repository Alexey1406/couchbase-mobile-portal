<?xml version="1.0" encoding="UTF-8"?>
<lesson xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../../docs.xsd" id="create-new-java-project">
  <title>Creating a new project</title>
  <introduction>
    <paragraph>
      This lesson shows you how to create a new project with the Couchbase Lite Java SDK in IntelliJ.
    </paragraph>
  </introduction>
  <tasks>

    <task id="create-project">
      <title>Creating a new project</title>
      <body>
        <paragraph>If you donâ€™t have IntelliJ IDEA already installed you can download the community
          edition from <external-ref href="https://www.jetbrains.com/idea/download/">here</external-ref>.</paragraph>
        <paragraph>Open IntelliJ IDEA and choose the <strong>Create New Project</strong> menu. On the left pane, select the Java application template and set the <strong>Project SDK</strong> to 1.8.</paragraph>
        <image href="images/cbl-java-new-proj.png" width="100%" alt=""/>
        <paragraph>Then click <strong>Next</strong>. Choose <strong>Command Line App</strong> for the project template.</paragraph>
        <image href="images/cbl-java-project-template.png" width="100%" alt=""/>
        <paragraph>Click <strong>Next</strong>. Fill in the <strong>Project name</strong>, <strong>Project location</strong> and <strong>Base package</strong>.</paragraph>
        <image href="images/cbl-java-project-detail.png" width="100%" alt=""/>
        <paragraph>Click <strong>Finish</strong>. A new project window will open in IntelliJ.</paragraph>
      </body>
    </task>

    <task id="add-lite">
      <title>Adding Couchbase Lite</title>
      <body>
        <paragraph>Follow the steps below to add Couchbase Lite as a dependency to your project:</paragraph>
        <ordered-list>
          <list-item>
            <paragraph>
              Download the Couchbase Lite Java SDK from <external-ref href="http://www.couchbase.com/nosql-databases/downloads#couchbase-mobile"/>.
            </paragraph>
          </list-item>
          <list-item>
            <paragraph>
              Open the <strong>File/Project Structure</strong> menu.
            </paragraph>
            <image href="images/cbljava-project-structure.png" width="50%" alt=""/>
          </list-item>
          <list-item>
            <paragraph>A new window will open. Select the <strong>Modules</strong> tab and add a new Library from Java.
            </paragraph>
            <image href="images/cbljava-addlib.png" width="100%" alt=""/>
          </list-item>
          <list-item>
            Select the directory where you downloaded the Couchbase Lite Java SDK, then click <strong>OK</strong>.
            <image href="images/cbljava-dir.png" width="100%" alt=""/>
          </list-item>
        </ordered-list>
        <paragraph>Run the application in Debug mode. The console window will open.</paragraph>
        <image href="images/cbljava-debug-mode.png" width="50%" alt=""/>
        <paragraph>In the next section you will add some code to create a database and save it to the database.</paragraph>
      </body>
    </task>

    <task id="persisting-data">
      <title>Persisting Data</title>
      <body>
        <paragraph>
          Open <strong>src/com.couchbase/Main.java</strong> in IntelliJ and add the following in the <strong>main</strong> method.
        </paragraph>
        <code-block language="java"><![CDATA[
// Enable logging
Logger log = Logger.getLogger("app");
log.setLevel(Level.ALL);
JavaContext context = new JavaContext();
// Create a manager
Manager manager = null;
try {
    manager = new Manager(context, Manager.DEFAULT_OPTIONS);
} catch (IOException e) {
    e.printStackTrace();
}
// Create or open the database named app
Database database = null;
try {
    database = manager.getDatabase("app");
} catch (CouchbaseLiteException e) {
    e.printStackTrace();
}
// The properties that will be saved on the document
Map<String, Object> properties = new HashMap<String, Object>();
properties.put("title", "Couchbase Mobile");
properties.put("sdk", "Java");
// Create a new document
Document document = database.createDocument();
// Save the document to the database
try {
    document.putProperties(properties);
} catch (CouchbaseLiteException e) {
    e.printStackTrace();
}
// Log the document ID (generated by the database)
// and properties
log.info(String.format("Document ID :: %s", document.getId()));
log.info(String.format("Learning %s with %s", (String) document.getProperty("title"), (String) document.getProperty("sdk")));        
        ]]>
        </code-block>
        <paragraph>Click the <strong>Debug</strong> button. Notice the document ID and properties are logged to the console.</paragraph>
        <image href="images/cbljava-log.png" width="100%" alt=""/>
      </body>
    </task>
  </tasks>
</lesson>

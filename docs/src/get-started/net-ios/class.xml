<?xml version="1.0" encoding="UTF-8"?>
<class xmlns:xi="http://www.w3.org/2001/XInclude"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:noNamespaceSchemaLocation="../../docs.xsd" id="net">
   <title>Application Development for iOS using .NET </title>
   <description>You will learn how to use the .NET framework to build applications for mobile phones running on the iOS operating systems. </description>
   <introduction>
      <paragraph>This section shows how to develop iOS applications using Xamarin Studio and Couchbase Lite .NET library. </paragraph>
   </introduction>

   <lessons>

      <lesson id="before-you-begin">
         <title>Before You Begin</title>
         <description>Install the neccessary tools.</description>
         <introduction>
            <paragraph>Before you can build an application with .NET, make sure you have the following tools on your computer. You might already have some of them installed.</paragraph>
         </introduction>
 <tasks>
            <task id="xamarin">
               <title>Xamarin Studio</title>
               <body>
                  <paragraph>If you don't already have it, download and set up Xamarin Studio:  <external-ref href="http://www.xamarin.com/"
                     >Xcode</external-ref>.</paragraph>
                  <ordered-list>
                     <list-item>Go to http://www.xamarin.com and download the Xamarin Studio.</list-item>
                     <list-item>Go to <external-ref href="http://www.xamarin.com/guides"
                        >Xcode</external-ref> to learn how to install and use Xamarin Studio to develep mobile and desktop applications.</list-item>
                  </ordered-list>
               </body>
            </task>

    <task id="new-project">
       <title>Create a New Project</title>
       <body>
          <paragraph>Open Xamarin Studio and do the following:</paragraph>
          <ordered-list>
             <list-item>Select <strong>File > New > Solution</strong>.</list-item> 
           
             <list-item>In the New Solution, select <strong>iOS > Classic API > iPhone > Empty Project</strong>.</list-item>
             <list-item>Enter the following information and click <strong>OK</strong>.</list-item>
          
             <unordered-list>
                
                <list-item>Name : HelloCBL</list-item>
                <list-item>Solution Name : HelloCBL</list-item>
                
             </unordered-list>
             
             
             <list-item>The HelloCBL solution will be created and opened. You should be able to see <code>AppDelegate.cs</code>, which is the starting point of the application.</list-item> 
             <list-item>Select <strong>View > Debug</strong>to see both the Solution structure and the editor pane.</list-item> 
          </ordered-list>
       </body>
    </task>

            <task id="cbl">
               <title>Add the Couchbase Lite .NET library</title>
               <body>
                  <paragraph>Developers can use Couchbase Lite .NET library by adding the Couchbase Lite .NET NuGet package.</paragraph>
                  <ordered-list>
                     <list-item>Select <strong>Project > Add Packages ...</strong>.</list-item>
                     <list-item>Search for 'Couchbase Lite' and select the latest version of the Couchbase Lite (as of 09/30 the latest version is 0.9.5) and click <strong>Add</strong>.</list-item>
                  </ordered-list>
                  <paragraph>It may take a few minutes for the Xamarin Studio to add the packages and all of the dependencies. Under HelloCBL > Packages, the following packages should be seen:</paragraph>
                  <unordered-list>
                     <list-item>Couchbase.Lite</list-item>
                     <list-item>Newtonsoft.Json</list-item>
                     <list-item>SQLitePCL.raw_basic</list-item>
                     <list-item>SQLitePCL.raw_needy</list-item>
                     <list-item>SQLitePCL.ugly</list-item>             
                  </unordered-list>
                                      
               </body>
            </task>
    

            <task id="starter-code">
               <title>Add the Starter Code</title>
               <body>
                  <paragraph>In AppDelegate.cs, add the a using statement as follows:</paragraph>
                  <paragraph><code-block>using Couchbase.Lite;</code-block></paragraph>
               </body>
            </task>
        
  </tasks>

      
      
      
      
      
      </lesson>

      <lesson id="create-database">
         <title>Creating a Manager and a Database</title>
         <description>TBA</description>
         <introduction>
            <paragraph>TBA</paragraph>
         </introduction>

         <tasks>
            <task id="manager">
               <title>Create a Manager</title>
               <body>
                <ordered-list>
                   <list-item>Add the following code to the <code>FinishedLaunching</code> method.</list-item>
                   
                   <unordered-list>
                      <list-item><code-block>// Create a shared manager</code-block></list-item>
                      <list-item><code-block>var manager = Manager.SharedInstance;</code-block></list-item>
                      <list-item><code-block>Debug.Assert(manager != null);</code-block></list-item>
                      <list-item><code-block>Console.WriteLine("Manager created");</code-block></list-item>
                      <note>
                         <type>note</type>The statement 'using System.Diagnostics' is required for the <code>Debug.Assert</code> method call.</note> 
                       
                   </unordered-list>
                   
                   <list-item>Select the Debug scheme and your desired iPhone Simulator. Click <strong>Run</strong> to run the application.</list-item>
                   <list-item>View the Application Output. It includes a message similar to the following one that says the run was successful:</list-item>
                   <paragraph><code-block>2014-09-30 20:02:34.911 HelloCBL[11943:302721] Manager created</code-block></paragraph>
                    
                </ordered-list>  
                  
               </body>
            </task>

            <task id="database">
               <title>Create a Database</title>
               <body>
                  <ordered-list>
                     <list-item>Add the following code to the <code>FinishedLaunching</code> method after the code that creates the manager.
                        </list-item>
                     
                     <unordered-list>
                        <list-item><code-block>var dbName = "hello";</code-block></list-item>
                        <list-item><code-block>Debug.Assert(Manager.IsValidDatabaseName(dbName));
                        </code-block></list-item>
                        <list-item><code-block>var database = manager.GetDatabase(dbName);</code-block></list-item>
                        <list-item><code-block>Debug.Assert(database != null);</code-block></list-item>
                       
                     </unordered-list>
                     <paragraph>The code snippet sets up and validates a name for the database and then creates the database. 
                        It is important to validate the database name because it must conform to the following rules:</paragraph>
                     <unordered-list>
                        <list-item>The database name must begin with a lowercase letter.</list-item>
                        <list-item>The database name must contain only valid characters. The following characters are valid in database names:</list-item>
                        
                        <unordered-list> 
                           <list-item># Lowercase letters: a-z</list-item>
                           <list-item># Numbers: 0-9</list-item>
                           <list-item># Special characters: _$()+-/</list-item>
                        </unordered-list>
                  
                        </unordered-list>
                     
                     <list-item>Run the application.</list-item>
                     <list-item>View the Application Output. It includes a message similar to the following one that indicates the database was created:</list-item>
                     <paragraph><code-block>2014-09-30 20:15:49.473 HelloCBL[12161:314012] Database created</code-block></paragraph>
                     
                  </ordered-list>  
                  
               </body>
            </task>
         </tasks>
      </lesson>
      
 
      
      <lesson id="crud">
         <title>Performing a CRUD Operations</title>
         <description>This section explains how to create, retrieve, update, and delete a document.</description>
         
         <tasks>
            <task id="create">
               <title>Create a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the FunishedLaunching method.
                        
                        <paragraph><code-block> var properties = new Dictionary &lt;string, object&gt;()
                           {
                           {"message", "Hello Couchbase Lite"},
                           {"created_at", DateTime.UtcNow.ToString("o")},
                           };
                           
                           var document = database.CreateDocument();
                           Debug.Assert(document != null);
                           
                           var revision = document.PutProperties(properties);
                           Debug.Assert(revision != null);
                           
                           var docId = document.Id;
                           Console.WriteLine("Document created with ID = {0}", docId);</code-block></paragraph>
                       

                     </list-item>Run the application. <list-item>
                       
                     </list-item>View the Application Output. The Application Output includes a message similar to the following one that indicates the document was created.
                     <paragraph><code-block> 2014-09-30 20:29:52.355 HelloCBL[12616:326285] Document created with ID: 43361e17-156f-4298-8822-19f5c2fbd86b</code-block></paragraph>
                      
                  </ordered-list>
               </body>
            </task>
            
            
         
           <task id="retrieve">
               <title>Retrieve a Document</title>
              <body>
                 <ordered-list>
                    <list-item> Add the following code to the FunishedLaunching method.
                       
                       <paragraph><code-block> var retrievedDocument = database.GetDocument(docId);
                          
                          Console.WriteLine("Retrieved document: ");
                          foreach (var kvp in retrievedDocument.Properties)
                          {
                          Console.WriteLine("{0} : {1}", kvp.Key, kvp.Value);
                          }
                          </code-block>   
                          
                    </list-item>Run the application. <list-item>
                       
                    </list-item>View the Application Output. The Application Output includes messages similar to the following one below.
                    <paragraph><code-block> 2014-09-30 20:38:10.102 HelloCBL[12763:333350] Retrieved document: 
                       2014-09-30 20:38:10.119 HelloCBL[12763:333350] message : Hello Couchbase Lite
                       2014-09-30 20:38:10.119 HelloCBL[12763:333350] created_at : 9/30/2014 1:38:10 PM
                       2014-09-30 20:38:10.119 HelloCBL[12763:333350] _id : 0c4b729b-02f2-4a7c-a538-1a39ff7e36c5
                       2014-09-30 20:38:10.119 HelloCBL[12763:333350] _rev : 1-8288BD9742C885DF11734DCFD4F14998</code-block></paragraph>
                      
                 </ordered-list>
              </body>
            </task>

            <task id="update">
               <title>Update a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the FunishedLaunching method.
                        
                        <paragraph><code-block> // Update a document
                           var updatedProperties = new Dictionary&lt;string, object&gt;(retrievedDocument.Properties);
                              updatedProperties["message"] = "We're having a heat wave!";
                              updatedProperties["temperature"] = 95.0;
                              
                              var updatedRevision = retrievedDocument.PutProperties(updatedProperties);
                              Debug.Assert(updatedRevision != null);
                              
                              Console.WriteLine("Updated document: ");
                              foreach (var kvp in updatedRevision.Document.Properties)
                              {
                              Console.WriteLine("{0} : {1}", kvp.Key, kvp.Value);
                              }
                              </code-block> 
                           
                           <list-item>Run the application.</list-item> 
                           <list-item>View the Application Output. It includes messages similar to the following one below:</list-item>
                           <paragraph><code-block> 
                              2014-09-30 20:52:34.414 HelloCBL[12989:344732] Updated document: 
                              2014-09-30 20:52:34.414 HelloCBL[12989:344732] message : We're having a heat wave!
                              2014-09-30 20:52:34.414 HelloCBL[12989:344732] created_at : 9/30/2014 1:52:34 PM
                              2014-09-30 20:52:34.414 HelloCBL[12989:344732] _id : a780c77b-ccfa-495e-8100-aed3cae64ec2
                              2014-09-30 20:52:34.414 HelloCBL[12989:344732] _rev : 2-A2C30E1FDAE634A9C345ECEE665CE0B4
                              2014-09-30 20:52:34.415 HelloCBL[12989:344732] temperature : 95  
                              
                              </code-block> </paragraph>  
                              
                  </ordered-list>
               </body>
            </task>
         
            <task id="delete">
               <title>Delete a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the FunishedLaunching method.
                        
                        <paragraph><code-block> v// Delete a document
                           retrievedDocument.Delete();
                           Console.WriteLine("Deleted document, deletion status: {0}", retrievedDocument.Deleted);
                        </code-block></paragraph>
                           
                     </list-item>Run the application. <list-item>
                        
                     </list-item>View the Application Output. Itincludes messages similar to the following one below.
                     <paragraph><code-block> 2014-09-30 20:59:24.479 HelloCBL[13091:350437] Deleted document, deletion status: True
                     </code-block></paragraph>
                     
                  </ordered-list>
               </body>
            </task>  
         
         
         
         </tasks>

      </lesson>
   </lessons>
</class>

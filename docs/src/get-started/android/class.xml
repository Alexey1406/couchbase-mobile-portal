<?xml version="1.0" encoding="UTF-8"?>
<class xmlns:xi="http://www.w3.org/2001/XInclude"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:noNamespaceSchemaLocation="../../docs.xsd" id="net">
   <title>Application Development for Android using .NET </title>
   <description>You will learn how to use the .NET framework to build applications for mobile phones running on the Android operating systems. </description>
   <introduction>
      <paragraph>This section shows how to develop Android applications using Xamarin Studio and Couchbase Lite .NET library. </paragraph>
   </introduction>

   <lessons>

      <lesson id="before-you-begin">
         <title>Before You Begin</title>
         <description>Install the neccessary tools.</description>
         <introduction>
            <paragraph>Before you can build an application with .NET, make sure you have the following tools on your computer. You might already have some of them installed.</paragraph>
         </introduction>
 <tasks>
            <task id="xamarin">
               <title>Xamarin Studio</title>
               <body>
                  <paragraph>If you don't already have it, download and set up Xamarin Studio:  <external-ref href="http://www.xamarin.com/"
                     >Xcode</external-ref>.</paragraph>
                  <ordered-list>
                     <list-item>Go to http://www.xamarin.com and download the Xamarin Studio.</list-item>
                     <list-item>Go to <external-ref href="http://www.xamarin.com/guides"
                        >Xcode</external-ref> to learn how to install and use Xamarin Studio to develep mobile and desktop applications.</list-item>
                  </ordered-list>
               </body>
            </task>

    <task id="new-project">
       <title>Create a New Project</title>
       <body>
          <paragraph>Open Xamarin Studio and do the following:</paragraph>
          <ordered-list>
             <list-item>Select <strong>File > New > Solution</strong>.</list-item> 
           
             <list-item>In the New Solution, select <strong>Android > Android Application</strong>.</list-item>
             <list-item>Enter the following information and click <strong>OK</strong>.</list-item>
          
             <unordered-list>
                
                <list-item>Name : HelloCBL</list-item>
                <list-item>Solution Name : HelloCBL</list-item>
                
             </unordered-list>
             
             
             <list-item>The HelloCBL solution will be created and opened. You should be able to see <code>MainActivity.cs</code>, which is the main activity of the application.</list-item> 
             <list-item>Select <strong>View > Debug</strong>to see both the Solution structure and the editor pane.</list-item> 
          </ordered-list>
       </body>
    </task>

            <task id="cbl">
               <title>Add the Couchbase Lite .NET library</title>
               <body>
                  <paragraph>Developers can use Couchbase Lite .NET library by adding the Couchbase Lite .NET NuGet package.</paragraph>
                  <ordered-list>
                     <list-item>Select <strong>Project > Add Packages ...</strong>.</list-item>
                     <list-item>Search for 'Couchbase Lite' and select the latest version of the Couchbase Lite (as of 09/30 the latest version is 0.9.5) and click <strong>Add</strong>.</list-item>
                  </ordered-list>
                  <paragraph>It may take a few minutes for the Xamarin Studio to add the packages and all of the dependencies. Under HelloCBL > Packages, the following packages should be seen:</paragraph>
                  <unordered-list>
                     <list-item>Couchbase.Lite</list-item>
                     <list-item>Newtonsoft.Json</list-item>
                     <list-item>SQLitePCL.raw_basic</list-item>
                     <list-item>SQLitePCL.raw_needy</list-item>
                     <list-item>SQLitePCL.ugly</list-item>             
                  </unordered-list>
                                      
               </body>
            </task>
    

            <task id="starter-code">
               <title>Add the Starter Code</title>
               <body>
                  <paragraph>In MainActivity.cs, add the using statement as follows:</paragraph>
                  <paragraph><code-block>using Couchbase.Lite;</code-block></paragraph>
               </body>
            </task>
        
  </tasks>

      
      
      
      
      
      </lesson>

      <lesson id="create-database">
         <title>Creating a Manager and a Database</title>
         <description>TBA</description>

         <tasks>
            <task id="manager">
               <title>Create a Manager</title>
               <body>
                <ordered-list>
                   <list-item>Add the following code to the <code>OnCreate/code> method.</list-item>
                           
                      <paragraph><code-block>// Create a shared manager
                         var manager = Manager.SharedInstance;
                         System.Diagnostics.Debug.Assert(manager != null);
                         Console.WriteLine("Manager created");</code-block></paragraph>
                  
                   
                   <list-item>Select the Debug scheme and your desired iPhone Simulator. Click <strong>Run</strong> to run the application.</list-item>
                   <list-item>View the Application Output. It includes a message similar to the following one that says the run was successful:</list-item>
                   <paragraph><code-block>Manager created</code-block></paragraph>
                    
                </ordered-list>  
                  
               </body>
            </task>

            <task id="database">
               <title>Create a Database</title>
               <body>
                  <ordered-list>
                     <list-item>Add the following code to the <code>OnCreate</code> method.
                        </list-item>
                     
                 
                     <paragraph><code-block>// Create database
                        var dbName = "hello";
                        System.Diagnostics.Debug.Assert(Manager.IsValidDatabaseName(dbName));
                        
                        var database = manager.GetDatabase(dbName);
                        System.Diagnostics.Debug.Assert(database != null);
                        Console.WriteLine("Database created");</code-block></paragraph>
                       
                     
                     <paragraph>The code snippet sets up and validates a name for the database and then creates the database. 
                        It is important to validate the database name because it must conform to the following rules:</paragraph>
                     <unordered-list>
                        <list-item>The database name must begin with a lowercase letter.</list-item>
                        <list-item>The database name must contain only valid characters. The following characters are valid in database names:</list-item>
                        
                        <unordered-list> 
                           <list-item># Lowercase letters: a-z</list-item>
                           <list-item># Numbers: 0-9</list-item>
                           <list-item># Special characters: _$()+-/</list-item>
                        </unordered-list>
                  
                        </unordered-list>
                     
                     <list-item>Run the application.</list-item>
                     <list-item>View the Application Output. It includes a message similar to the following one that indicates the database was created:</list-item>
                     <paragraph><code-block>Database created</code-block></paragraph>
                     
                  </ordered-list>  
                  
               </body>
            </task>
         </tasks>
      </lesson>
      
 
      
      <lesson id="crud">
         <title>Performing a CRUD Operations</title>
         <description>This section explains how to create, retrieve, update, and delete a document.</description>
         
         <tasks>
            <task id="create">
               <title>Create a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the OnCreate method.
                        
                        <paragraph><code-block> var properties = new Dictionary &lt;string, object&gt;()
                           {
                           {"message", "Hello Couchbase Lite"},
                           {"created_at", DateTime.UtcNow.ToString("o")},
                           };
                           
                           var document = database.CreateDocument();
                           Debug.Assert(document != null);
                           
                           var revision = document.PutProperties(properties);
                           Debug.Assert(revision != null);
                           
                           var docId = document.Id;
                           Console.WriteLine("Document created with ID = {0}", docId);</code-block></paragraph>
                       

                     </list-item>Run the application. <list-item>
                       
                     </list-item>View the Application Output. The Application Output includes a message similar to the following one that indicates the document was created.
                     <paragraph><code-block> Document created with ID = 40618a26-c690-4a8b-9481-c4fdfdfa4b82</code-block></paragraph>
                      
                  </ordered-list>
               </body>
            </task>
            
            
         
           <task id="retrieve">
               <title>Retrieve a Document</title>
              <body>
                 <ordered-list>
                    <list-item> Add the following code to the OnCreate method.
                       
                       <paragraph><code-block> // Retrieve a document
                          var retrievedDocument = database.GetDocument(docId);
                          
                          Console.WriteLine("Retrieved document: ");
                          foreach (var kvp in retrievedDocument.Properties)
                          {
                          Console.WriteLine("{0} : {1}", kvp.Key, kvp.Value);
                          }
                          </code-block>   
                          
                    </list-item>Run the application. <list-item>
                       
                    </list-item>View the Application Output. It includes messages similar to the following one below.
                    <paragraph><code-block> message : Hello Couchbase Lite
                       created_at : 10/1/2014 2:44:19 PM
                       _id : 40618a26-c690-4a8b-9481-c4fdfdfa4b82
                       _rev : 1-BC78382B76A92D16C1EA8ABC95B82981</code-block></paragraph>
                      
                 </ordered-list>
              </body>
            </task>

            <task id="update">
               <title>Update a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the OnCreate method.
                        
                        <paragraph><code-block>// Update a document
                           var updatedProperties = new Dictionary&lt;string, object&gt;(retrievedDocument.Properties);
                              updatedProperties["message"] = "We're having a heat wave!";
                              updatedProperties["temperature"] = 95.0;
                              
                              var updatedRevision = retrievedDocument.PutProperties(updatedProperties);
                              System.Diagnostics.Debug.Assert(updatedRevision != null);
                              
                              Console.WriteLine("Updated document: ");
                              foreach (var kvp in updatedRevision.Document.Properties)
                              {
                              Console.WriteLine("{0} : {1}", kvp.Key, kvp.Value);
                              }
                              </code-block> 
                           
                           <list-item>Run the application.</list-item> 
                           <list-item>View the Application Output. It includes messages similar to the following one below:</list-item>
                           <paragraph><code-block> 
                              Updated document: 
                              message : We're having a heat wave!
                              created_at : 10/1/2014 2:44:19 PM
                              _id : 40618a26-c690-4a8b-9481-c4fdfdfa4b82
                              _rev : 2-4DB2DB4ABCBFD12CC6A0A24DD6A8C541
                              temperature : 95
                              </code-block> </paragraph>  
                              
                  </ordered-list>
               </body>
            </task>
         
            <task id="delete">
               <title>Delete a Document</title>
               <body>
                  <ordered-list>
                     <list-item> Add the following code to the OnCreate method.
                        
                        <paragraph><code-block> // Delete a document
                           retrievedDocument.Delete();
                           Console.WriteLine("Deleted document, deletion status: {0}", retrievedDocument.Deleted);
                        </code-block></paragraph>
                           
                     </list-item>Run the application. <list-item>
                        
                     </list-item>View the Application Output. It includes messages similar to the following one below.
                     <paragraph><code-block> Deleted document, deletion status: True
                     </code-block></paragraph>
                     
                  </ordered-list>
               </body>
            </task>  
         
         
         
         </tasks>

      </lesson>
      
      <xi:include href="../../../src/training/couchbase-lite/build-first-android-app/get-started-android-eclipse.xml"></xi:include>
            <xi:include href="../../../src/training/couchbase-lite/build-first-android-app/get-started-android-studio.xml"></xi:include>
   </lessons>
</class>
